<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Boltmovies</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#0b0b0b;--text:#fff;--card:#141414;
}
.light{
  --bg:#f5f5f5;--text:#000;--card:#fff;
}
body{
  margin:0;background:var(--bg);color:var(--text);
  font-family:Arial,sans-serif;
}
header{
  padding:10px;display:flex;gap:10px;
  background:var(--card);position:sticky;top:0;
}
input,button,select{
  padding:10px;border:none;border-radius:6px;
}
button{background:#e50914;color:#fff;cursor:pointer}

.section{padding:15px}
.row{display:flex;gap:10px;overflow-x:auto}
.card{min-width:140px;cursor:pointer}
.card img{width:100%;border-radius:8px}

iframe{width:100%;height:60vh;border:none}
.controls{display:flex;gap:10px;padding:10px}

/* Intro */
#intro{
  position:fixed;inset:0;background:black;
  display:flex;flex-direction:column;
  justify-content:center;align-items:center;
  z-index:9999;
}
#intro h1{color:#e50914;font-size:60px}
#episodeBox{
  position:fixed;inset:0;background:#000c;
  display:none;overflow:auto;
}
#episodeBox div{
  background:var(--card);margin:10px;padding:10px;
}
</style>
</head>

<body>

<div id="intro" onclick="startIntro()">
  <h1>BOLTMOVIES</h1>
  <p>Tap to enter</p>
</div>
<audio id="introSound" src="netflix.mp3"></audio>

<header>
  <input id="q" placeholder="Search">
  <button onclick="search()">Search</button>
  <button onclick="toggleTheme()">ðŸŒ“</button>
</header>

<div class="section">
  <h2>â–¶ Continue Watching</h2>
  <div class="row" id="continue"></div>
</div>

<div class="section">
  <h2>ðŸ”¥ Trending</h2>
  <div class="row" id="trending"></div>
</div>

<iframe id="player"></iframe>
<div class="controls">
  <button onclick="nextEpisode()">â–¶ Next Episode</button>
  <button onclick="showEpisodes()">ðŸ“º Episodes</button>
</div>

<div id="episodeBox" onclick="this.style.display='none'"></div>

<script>
/* ===== CONFIG ===== */
const TMDB_API = "s";

/* ===== PROFILE ===== */
let profile = localStorage.getItem("bm_profile");
if(!profile){
  profile = prompt("Profile name?");
  localStorage.setItem("bm_profile",profile);
}

/* ===== INTRO ===== */
function startIntro(){
  introSound.play();
  intro.style.display="none";
}

/* ===== THEME ===== */
document.body.className =
 localStorage.getItem(profile+"theme")||"";
function toggleTheme(){
  document.body.classList.toggle("light");
  localStorage.setItem(profile+"theme",document.body.className);
}

/* ===== GLOBAL STATE ===== */
let currentTV=null,currentSeason=1,currentEpisode=1;

/* ===== LOAD TRENDING ===== */
fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=${TMDB_API}`)
.then(r=>r.json()).then(d=>{
  d.results.slice(0,12).forEach(i=>addCard(i,trending));
});

function addCard(i,row){
  if(!i.poster_path)return;
  const c=document.createElement("div");
  c.className="card";
  c.innerHTML=`<img src="https://image.tmdb.org/t/p/w500${i.poster_path}">`;
  c.onclick=()=>play(i);
  row.appendChild(c);
}

/* ===== PLAY ===== */
function play(item){
  if(item.media_type==="tv"){
    currentTV=item.id;
    let p=getProgress(item.id);
    currentSeason=p?.season||1;
    currentEpisode=p?.episode||1;
    player.src=`https://vidsrc.to/embed/tv/${item.id}/${currentSeason}/${currentEpisode}`;
  }else{
    player.src=`https://vidsrc.to/embed/movie/${item.id}`;
  }
  saveContinue(item);
}

/* ===== NEXT EPISODE ===== */
function nextEpisode(){
  if(!currentTV)return alert("TV shows only");
  currentEpisode++;
  saveProgress(currentTV,currentSeason,currentEpisode);
  player.src=`https://vidsrc.to/embed/tv/${currentTV}/${currentSeason}/${currentEpisode}`;
}

/* ===== EPISODE LIST ===== */
function showEpisodes(){
  if(!currentTV)return;
  episodeBox.style.display="block";
  episodeBox.innerHTML="";
  fetch(`https://api.themoviedb.org/3/tv/${currentTV}/season/${currentSeason}?api_key=${TMDB_API}`)
  .then(r=>r.json()).then(d=>{
    d.episodes.forEach(e=>{
      const div=document.createElement("div");
      div.innerText=`Episode ${e.episode_number}`;
      div.onclick=()=>{
        currentEpisode=e.episode_number;
        saveProgress(currentTV,currentSeason,currentEpisode);
        player.src=`https://vidsrc.to/embed/tv/${currentTV}/${currentSeason}/${currentEpisode}`;
        episodeBox.style.display="none";
      };
      episodeBox.appendChild(div);
    });
  });
}

/* ===== AUTO NEXT (when iframe reloads) ===== */
player.addEventListener("load",()=>{
  if(currentTV)saveProgress(currentTV,currentSeason,currentEpisode);
});

/* ===== STORAGE ===== */
function saveProgress(id,s,e){
  let p=JSON.parse(localStorage.getItem(profile+"eps")||"{}");
  p[id]={season:s,episode:e};
  localStorage.setItem(profile+"eps",JSON.stringify(p));
}
function getProgress(id){
  return JSON.parse(localStorage.getItem(profile+"eps")||"{}")[id];
}

function saveContinue(item){
  let c=JSON.parse(localStorage.getItem(profile+"cont")||"[]");
  c=c.filter(x=>x.id!==item.id);
  c.unshift(item);
  localStorage.setItem(profile+"cont",JSON.stringify(c.slice(0,5)));
  loadContinue();
}
function loadContinue(){
  continue.innerHTML="";
  let c=JSON.parse(localStorage.getItem(profile+"cont")||"[]");
  c.forEach(i=>addCard(i,continue));
}
loadContinue();

/* ===== SEARCH ===== */
function search(){
  fetch(`https://api.themoviedb.org/3/search/multi?api_key=${TMDB_API}&query=${q.value}`)
  .then(r=>r.json()).then(d=>{
    trending.innerHTML="";
    d.results.forEach(i=>addCard(i,trending));
  });
}
</script>

</body>
</html>
